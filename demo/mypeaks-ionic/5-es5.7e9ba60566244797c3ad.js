!function(){function t(e,i,n){return(t="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,i){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=c(t)););return t}(t,e);if(n){var r=Object.getOwnPropertyDescriptor(n,e);return r.get?r.get.call(i):r.value}})(e,i,n||e)}function e(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return i(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var i,n=c(t);if(e){var r=c(this).constructor;i=Reflect.construct(n,arguments,r)}else i=n.apply(this,arguments);return u(this,i)}}function u(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?l(t):e}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function h(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[5,69],{"1G5W":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var r=i("l7GE"),u=i("ZUHj");function l(t){return function(e){return e.lift(new c(t))}}var c=function(){function t(e){o(this,t),this.notifier=e}return h(t,[{key:"call",value:function(t,e){var i=new a(t),n=Object(u.a)(i,this.notifier);return n&&!i.seenValue?(i.add(n),e.subscribe(i)):i}}]),t}(),a=function(t){n(i,t);var e=s(i);function i(t){var n;return o(this,i),(n=e.call(this,t)).seenValue=!1,n}return h(i,[{key:"notifyNext",value:function(t,e,i,n,r){this.seenValue=!0,this.complete()}},{key:"notifyComplete",value:function(){}}]),i}(r.a)},"44mT":function(t,i,r){"use strict";r.d(i,"a",(function(){return O}));var u=r("mrSG"),l=r("LvDl"),c=r("2Vo4"),a=r("itXk"),b=r("/uUt"),f=r("7o/Q"),v=r("D0XW");function d(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:v.a;return function(i){return i.lift(new p(t,e))}}var p=function(){function t(e,i){o(this,t),this.dueTime=e,this.scheduler=i}return h(t,[{key:"call",value:function(t,e){return e.subscribe(new g(t,this.dueTime,this.scheduler))}}]),t}(),g=function(t){n(i,t);var e=s(i);function i(t,n,r){var s;return o(this,i),(s=e.call(this,t)).dueTime=n,s.scheduler=r,s.debouncedSubscription=null,s.lastValue=null,s.hasValue=!1,s}return h(i,[{key:"_next",value:function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(y,this.dueTime,this))}},{key:"_complete",value:function(){this.debouncedNext(),this.destination.complete()}},{key:"debouncedNext",value:function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}},{key:"clearDebounce",value:function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}]),i}(f.a);function y(t){t.debouncedNext()}var m,k,S=r("zptW"),F=r("DPk/"),L=r("n90K"),w=r("fXoL"),x=((k=function(){function t(e){o(this,t),this.storageService=e}return h(t,[{key:"get",value:function(t,e){return this.storageService.get("prefs."+t,e)}},{key:"set",value:function(t,e){return this.storageService.set("prefs."+t,e)}}]),t}()).\u0275fac=function(t){return new(t||k)(w.Qb(L.a))},k.\u0275prov=w.Db({token:k,factory:k.\u0275fac,providedIn:"root"}),k),O=((m=function(){function t(e,i,n){o(this,t),this.hillsService=e,this.userDataService=i,this.userPrefsService=n,this.defaultSort="name#asc",this.list=new c.a(null),this.region=new c.a(null),this.status=new c.a(null),this.sortBy=new c.a(this.defaultSort),this.filteredSnapshot=[],this.filteredHills=new c.a([]),this.filterMessage=new c.a(null),this.termFilter="",this.totalHillCount=0,this.prefsKey="filter",this.sortKey="sort",this.hasUserPrefs=!1,this.observeFilters(),this.resetFilters(),this.totalHillCount=this.hillsService.getHills().length,this.loadUserPrefs()}return h(t,[{key:"resetFilters",value:function(){this.updateList(null),this.updateRegion(null),this.updateTerm(null)}},{key:"updateList",value:function(t){this.list.next(t)}},{key:"updateRegion",value:function(t){this.region.next(t)}},{key:"updateStatus",value:function(t){this.status.next(t)}},{key:"updateTerm",value:function(t){this.termFilter=(t||"").toLocaleLowerCase(),this.updateFilteredHills()}},{key:"updateSort",value:function(t){this.sortBy.next(t||this.defaultSort),this.updateFilteredHills(),this.userPrefsService.set(this.sortKey,this.sortBy.value)}},{key:"observeFilters",value:function(){var t=this,e=[this.list.pipe(Object(b.a)()),this.region.pipe(Object(b.a)()),this.status.pipe(Object(b.a)())];Object(a.a)(e).pipe(d(300)).subscribe((function(){t.performFiltering()}));var i=[this.userDataService.loggedHillIds$,this.userDataService.targetHillIds$];Object(a.a)(i).pipe(d(300)).subscribe((function(){t.currentFilters.status&&t.performFiltering()}))}},{key:"performFiltering",value:function(){var t=null;if(this.list.value&&(t=this.hillsService.getHillsInList(this.list.value)),this.region.value){var e=this.hillsService.getHillsInRegion(this.region.value);t=t?l.intersection(t,e):e}if(this.status.value){var i=this.hillsMatchingStatus(this.status.value);t=t?l.intersection(t,i):i}t||(t=this.hillsService.getHills()),this.filteredSnapshot=t,this.updateFilteredHills(),this.hasUserPrefs&&this.userPrefsService.set("filter",this.currentFilters)}},{key:"updateFilteredHills",value:function(){var t=this,e=null;this.termFilter||(e=this.filteredSnapshot),e=this.filteredSnapshot.filter((function(e){return e.name.toLocaleLowerCase().includes(t.termFilter)}));var i=this.sortBy.value.split("#");this.filteredHills.next(l.orderBy(e,[i[0]],[i[1]||"asc"])),this.filterMessage.next(e.length<this.totalHillCount?"Showing ".concat(e.length,"/").concat(this.totalHillCount):null)}},{key:"hillsMatchingStatus",value:function(t){switch(t){case"targets":return this.userDataService.targetHills;case"climbed":return this.userDataService.climbedHills;case"none":return this.userDataService.statelessHills}return[]}},{key:"loadUserPrefs",value:function(){return Object(u.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.t0=this.sortBy,t.next=4,this.userPrefsService.get(this.sortKey,this.defaultSort);case 4:return t.t1=t.sent,t.t0.next.call(t.t0,t.t1),t.next=8,this.userPrefsService.get(this.prefsKey,{list:null,region:null,status:null});case 8:e=t.sent,this.updateList(e.list),this.updateRegion(e.region),this.updateStatus(e.status),this.hasUserPrefs=!0,t.next=15;break;case 12:t.prev=12,t.t2=t.catch(0),console.error("Failed to load user prefs for filtering",t.t2);case 15:case"end":return t.stop()}}),t,this,[[0,12]])})))}},{key:"listOptions",get:function(){return[{title:"All Lists",value:null}].concat(e(this.hillsService.getLists().map((function(t){return{title:t.name,subtitle:t.description,value:t.id}}))))}},{key:"regionOptions",get:function(){var t=null;return[{title:"All Regions",value:null}].concat(e(this.hillsService.getRegions().map((function(e){var i={title:e.name,group:e.country!==t?e.country:null,value:e.name};return t=e.country,i}))))}},{key:"statusOptions",get:function(){return[{title:"Any Status",value:null},{title:"Targets",subtitle:"Hills you have marked as a target",value:"targets"},{title:"Climbed",subtitle:"Hills with log entries",value:"climbed"},{title:"None",subtitle:"Hills that are neither targets nor climbed",value:"none"}]}},{key:"list$",get:function(){return this.list.asObservable()}},{key:"region$",get:function(){return this.region.asObservable()}},{key:"status$",get:function(){return this.status.asObservable()}},{key:"sort$",get:function(){return this.sortBy.asObservable()}},{key:"filteredHills$",get:function(){return this.filteredHills.asObservable()}},{key:"filterMessage$",get:function(){return this.filterMessage.asObservable()}},{key:"currentFilters",get:function(){return{list:this.list.value,region:this.region.value,status:this.status.value}}},{key:"currentTerm",get:function(){return this.termFilter}},{key:"currentSort",get:function(){return this.sortBy.value||this.defaultSort}}]),t}()).\u0275fac=function(t){return new(t||m)(w.Qb(S.a),w.Qb(F.a),w.Qb(x))},m.\u0275prov=w.Db({token:m,factory:m.\u0275fac,providedIn:"root"}),m)},D0XW:function(e,i,r){"use strict";r.d(i,"a",(function(){return b}));var u=function(t){n(i,t);var e=s(i);function i(t,n){var r;return o(this,i),(r=e.call(this,t,n)).scheduler=t,r.work=n,r.pending=!1,r}return h(i,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=t;var i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(n,this.id,e),this}},{key:"requestAsyncId",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(t.flush.bind(t,this),i)}},{key:"recycleAsyncId",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==i&&this.delay===i&&!1===this.pending)return e;clearInterval(e)}},{key:"execute",value:function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var i=this._execute(t,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(t,e){var i=!1,n=void 0;try{this.work(t)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}},{key:"_unsubscribe",value:function(){var t=this.id,e=this.scheduler,i=e.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null}}]),i}(function(t){n(i,t);var e=s(i);function i(t,n){return o(this,i),e.call(this)}return h(i,[{key:"schedule",value:function(t){return this}}]),i}(r("quSY").a)),a=function(){var t=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.now;o(this,t),this.SchedulerAction=e,this.now=i}return h(t,[{key:"schedule",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,t).schedule(i,e)}}]),t}();return t.now=function(){return Date.now()},t}(),b=new(function(e){n(r,e);var i=s(r);function r(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.now;return o(this,r),(e=i.call(this,t,(function(){return r.delegate&&r.delegate!==l(e)?r.delegate.now():n()}))).actions=[],e.active=!1,e.scheduled=void 0,e}return h(r,[{key:"schedule",value:function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return r.delegate&&r.delegate!==this?r.delegate.schedule(e,i,n):t(c(r.prototype),"schedule",this).call(this,e,i,n)}},{key:"flush",value:function(t){var e=this.actions;if(this.active)e.push(t);else{var i;this.active=!0;do{if(i=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}}}]),r}(a))(u)},na4s:function(t,e,i){"use strict";i.d(e,"a",(function(){return b}));var n=i("XNiG"),r=i("44mT"),s=i("1G5W"),u=i("fXoL"),l=i("ofXK"),c=i("TEn/");function a(t,e){if(1&t){var i=u.Nb();u.Mb(0,"ion-toolbar"),u.Mb(1,"ion-title"),u.oc(2),u.Lb(),u.Mb(3,"ion-buttons",1),u.Mb(4,"ion-button",2),u.Ub("click",(function(){return u.jc(i),u.Yb().resetFilters()})),u.oc(5,"Reset"),u.Lb(),u.Lb(),u.Lb()}if(2&t){var n=u.Yb();u.xb(2),u.qc(" ",n.message," ")}}var b=function(){var t=function(){function t(e){o(this,t),this.hillFilterService=e,this.message=null,this.unsubscribe=new n.a}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.hillFilterService.filterMessage$.pipe(Object(s.a)(this.unsubscribe)).subscribe((function(e){return t.message=e}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"resetFilters",value:function(){this.hillFilterService.resetFilters()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(u.Hb(r.a))},t.\u0275cmp=u.Bb({type:t,selectors:[["mp-hill-filter-status"]],decls:1,vars:1,consts:[[4,"ngIf"],["slot","end"],[3,"click"]],template:function(t,e){1&t&&u.nc(0,a,6,1,"ion-toolbar",0),2&t&&u.dc("ngIf",e.message)},directives:[l.j,c.L,c.K,c.g,c.f],styles:[""]}),t}()},phR7:function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var n=i("mrSG"),r=i("2Vo4"),s=i("XNiG"),u=i("1G5W"),l=i("44mT"),c=i("fXoL"),a=i("TEn/"),b=i("ofXK");function f(t,e){if(1&t&&(c.Mb(0,"ion-item-divider"),c.oc(1),c.Lb()),2&t){var i=e.$implicit;c.xb(1),c.qc(" ",i," ")}}function v(t,e){if(1&t&&(c.Mb(0,"p"),c.oc(1),c.Lb()),2&t){var i=c.Yb().$implicit;c.xb(1),c.pc(i.subtitle)}}function d(t,e){if(1&t){var i=c.Nb();c.Mb(0,"ion-item",4),c.Ub("click",(function(){c.jc(i);var t=e.$implicit;return c.Yb().select(t)})),c.Mb(1,"ion-label"),c.Mb(2,"h4"),c.oc(3),c.Lb(),c.nc(4,v,2,1,"p",5),c.Lb(),c.Lb()}if(2&t){var n=e.$implicit;c.xb(3),c.pc(n.title),c.xb(1),c.dc("ngIf",n.subtitle)}}var p,g=((p=function(){function t(e){o(this,t),this.popoverController=e,this.items=[],this.current=null}return h(t,[{key:"headerFn",value:function(t){return t.group}},{key:"select",value:function(t){this.popoverController.dismiss(t.value)}}]),t}()).\u0275fac=function(t){return new(t||p)(c.Hb(a.S))},p.\u0275cmp=c.Bb({type:p,selectors:[["mp-picker"]],inputs:{items:"items",current:"current"},decls:4,vars:2,consts:[["scrollY","false"],[3,"items","headerFn"],[4,"virtualHeader"],[3,"click",4,"virtualItem"],[3,"click"],[4,"ngIf"]],template:function(t,e){1&t&&(c.Mb(0,"ion-content",0),c.Mb(1,"ion-virtual-scroll",1),c.nc(2,f,2,1,"ion-item-divider",2),c.nc(3,d,5,2,"ion-item",3),c.Lb(),c.Lb()),2&t&&(c.xb(1),c.dc("items",e.items)("headerFn",e.headerFn))},directives:[a.i,a.M,a.X,a.Y,a.q,a.p,a.u,b.j],styles:["ion-list-header[_ngcontent-%COMP%]{font-size:.8rem;text-transform:capitalize;background:#efefef}"]}),p),y=i("6m4Z"),m=["termFilter"];function k(t,e){if(1&t){var i=c.Nb();c.Mb(0,"ion-toolbar",8),c.Ub("click",(function(t){return c.jc(i),c.Yb().openListPicker(t)})),c.Mb(1,"span"),c.oc(2),c.Lb(),c.Mb(3,"ion-buttons",7),c.Mb(4,"ion-button"),c.Ib(5,"ion-icon",10),c.Lb(),c.Lb(),c.Lb()}if(2&t){var n=c.Yb();c.xb(1),c.zb("active",null!==n.currentState.list),c.xb(1),c.qc("List: ",n.currentListLabel,"")}}function S(t,e){if(1&t){var i=c.Nb();c.Mb(0,"ion-toolbar",8),c.Ub("click",(function(t){return c.jc(i),c.Yb().openRegionPicker(t)})),c.Mb(1,"span"),c.oc(2),c.Lb(),c.Mb(3,"ion-buttons",7),c.Mb(4,"ion-button"),c.Ib(5,"ion-icon",10),c.Lb(),c.Lb(),c.Lb()}if(2&t){var n=c.Yb();c.xb(1),c.zb("active",null!==n.currentState.region),c.xb(1),c.qc("Region: ",n.currentRegionLabel,"")}}var F,L=function(t){return t[t.lists=0]="lists",t[t.regions=1]="regions",t[t.targets=2]="targets",t[t.climbed=3]="climbed",t}({}),w=((F=function(){function t(e,i,n){o(this,t),this.hillFilterService=e,this.popoverController=i,this.nativeService=n,this.lists=[],this.regions=[],this.sortOptions=[],this.term=new r.a(""),this.FilterChoice=L,this.unsubscribe=new s.a,this.mostRecentList=null,this.mostRecentRegion=null}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.lists=this.hillFilterService.listOptions,this.regions=this.hillFilterService.regionOptions,this.sortOptions=[{title:"Hill Name",value:"name#asc",group:"Sort by"},{title:"Height (Highest to Lowest)",value:"heightFeet#desc"},{title:"Height (Lowest to Highest)",value:"heightFeet#asc"}],this.currentState=this.hillFilterService.currentFilters,this.currentSort=this.hillFilterService.currentSort,this.activeFilter=L.lists,this.subscribeToFilters(),this.nativeService.keyboardDidHide$.pipe(Object(u.a)(this.unsubscribe)).subscribe((function(){return t.blurInput()}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"updateChoice",value:function(t){this.activeFilter===L.lists&&(this.mostRecentList=this.currentState.list,this.hillFilterService.updateList(null)),this.activeFilter===L.regions&&(this.mostRecentRegion=this.currentState.region,this.hillFilterService.updateRegion(null)),this.activeFilter!==L.targets&&this.activeFilter!==L.climbed||this.hillFilterService.updateStatus(null),this.activeFilter=Number.parseInt(t,10),this.activeFilter===L.lists&&this.hillFilterService.updateList(this.mostRecentList),this.activeFilter===L.regions&&this.hillFilterService.updateRegion(this.mostRecentRegion),this.activeFilter===L.targets&&this.hillFilterService.updateStatus("targets"),this.activeFilter===L.climbed&&this.hillFilterService.updateStatus("climbed")}},{key:"openListPicker",value:function(t){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showPicker(this.lists,this.currentState.list,t);case 2:void 0!==(i=e.sent)&&this.hillFilterService.updateList(i);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"openRegionPicker",value:function(t){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showPicker(this.regions,this.currentState.region,t);case 2:void 0!==(i=e.sent)&&this.hillFilterService.updateRegion(i);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"openSortPicker",value:function(t){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function e(){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.showPicker(this.sortOptions,this.currentSort,t);case 2:void 0!==(i=e.sent)&&this.hillFilterService.updateSort(i);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateTerm",value:function(t){this.hillFilterService.updateTerm(t)}},{key:"subscribeToFilters",value:function(){var t=this;this.hillFilterService.list$.pipe(Object(u.a)(this.unsubscribe)).subscribe((function(e){return t.currentState.list=e})),this.hillFilterService.region$.pipe(Object(u.a)(this.unsubscribe)).subscribe((function(e){return t.currentState.region=e})),this.hillFilterService.status$.pipe(Object(u.a)(this.unsubscribe)).subscribe((function(e){return t.currentState.status=e})),this.hillFilterService.sort$.pipe(Object(u.a)(this.unsubscribe)).subscribe((function(e){return t.currentSort=e}))}},{key:"showPicker",value:function(t,e,i){var r=this;return new Promise((function(s){return Object(n.a)(r,void 0,void 0,regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.popoverController.create({component:g,componentProps:{items:t,current:e},event:i});case 2:return(r=n.sent).onDidDismiss().then((function(t){var e=t.data;s(e)})),n.next=6,r.present();case 6:case"end":return n.stop()}}),n,this)})))}))}},{key:"blurInput",value:function(){return Object(n.a)(this,void 0,void 0,regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.termFilter.getInputElement();case 3:t.sent.blur(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"currentListLabel",get:function(){var t=this,e=this.lists.find((function(e){return e.value===t.currentState.list}));return e?e.title:""}},{key:"currentRegionLabel",get:function(){var t=this,e=this.regions.find((function(e){return e.value===t.currentState.region}));return e?e.title:""}},{key:"currentSortLabel",get:function(){var t=this,e=this.sortOptions.find((function(e){return e.value===t.currentSort}));return e?e.title:""}}]),t}()).\u0275fac=function(t){return new(t||F)(c.Hb(l.a),c.Hb(a.S),c.Hb(y.a))},F.\u0275cmp=c.Bb({type:F,selectors:[["mp-hill-filters"]],viewQuery:function(t,e){var i;1&t&&c.sc(m,!0),2&t&&c.hc(i=c.Vb())&&(e.termFilter=i.first)},decls:26,vars:7,consts:[["color","primary"],["slot","start"],[3,"value","ionChange"],[3,"value"],[3,"click",4,"ngIf"],["placeholder","Filter this list...","debounce","400",3,"ionChange"],["termFilter",""],["slot","end"],[3,"click"],["name","funnel"],["name","caret-down"]],template:function(t,e){1&t&&(c.Mb(0,"ion-header"),c.Mb(1,"ion-toolbar",0),c.Mb(2,"ion-buttons",1),c.Mb(3,"ion-menu-toggle"),c.Ib(4,"ion-menu-button"),c.Lb(),c.Ib(5,"ion-back-button"),c.Lb(),c.Mb(6,"ion-title"),c.oc(7,"Hill Finder"),c.Lb(),c.Lb(),c.Mb(8,"ion-toolbar"),c.Mb(9,"ion-segment",2),c.Ub("ionChange",(function(t){return e.updateChoice(t.detail.value)})),c.Mb(10,"ion-segment-button",3),c.oc(11,"Lists"),c.Lb(),c.Mb(12,"ion-segment-button",3),c.oc(13,"Regions"),c.Lb(),c.Mb(14,"ion-segment-button",3),c.oc(15,"Targets"),c.Lb(),c.Mb(16,"ion-segment-button",3),c.oc(17,"Climbed"),c.Lb(),c.Lb(),c.Lb(),c.nc(18,k,6,3,"ion-toolbar",4),c.nc(19,S,6,3,"ion-toolbar",4),c.Mb(20,"ion-toolbar"),c.Mb(21,"ion-searchbar",5,6),c.Ub("ionChange",(function(t){return e.updateTerm(t.detail.value)})),c.Lb(),c.Mb(23,"ion-buttons",7),c.Mb(24,"ion-button",8),c.Ub("click",(function(t){return e.openSortPicker(t)})),c.Ib(25,"ion-icon",9),c.Lb(),c.Lb(),c.Lb(),c.Lb()),2&t&&(c.xb(9),c.dc("value",e.activeFilter),c.xb(1),c.dc("value",e.FilterChoice.lists),c.xb(2),c.dc("value",e.FilterChoice.regions),c.xb(2),c.dc("value",e.FilterChoice.targets),c.xb(2),c.dc("value",e.FilterChoice.climbed),c.xb(2),c.dc("ngIf",e.activeFilter===e.FilterChoice.lists),c.xb(1),c.dc("ngIf",e.activeFilter===e.FilterChoice.regions))},directives:[a.n,a.L,a.g,a.z,a.y,a.c,a.d,a.K,a.C,a.U,a.D,b.j,a.B,a.V,a.f,a.o],styles:["ion-toolbar[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding:.5rem 1rem}.active[_ngcontent-%COMP%]{font-weight:700}"]}),F)},yNfC:function(t,e,i){"use strict";i.d(e,"a",(function(){return w}));var n=i("fXoL"),r=i("XNiG"),s=i("1G5W"),u=i("44mT"),l=i("ofXK"),c=i("TEn/"),a=(i("Lp9l"),i("DPk/"));function b(t,e){if(1&t&&n.Ib(0,"ion-icon",3),2&t){var i=n.Yb();n.dc("name",i.iconName)}}var f,v=((f=function(){function t(e){o(this,t),this.userDataService=e,this.logged=[],this.targets=[],this.unsubscribe=new r.a}return h(t,[{key:"ngOnInit",value:function(){var t=this;this.userDataService.loggedHillIds$.pipe(Object(s.a)(this.unsubscribe)).subscribe((function(e){t.logged=e,t.updateIcon()})),this.userDataService.targetHillIds$.pipe(Object(s.a)(this.unsubscribe)).subscribe((function(e){t.targets=e,t.updateIcon()}))}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"ngOnChanges",value:function(){this.updateIcon()}},{key:"updateIcon",value:function(){this.iconName=this.logged.includes(this.hill.id)?"checkmark":this.targets.includes(this.hill.id)?"star":null}}]),t}()).\u0275fac=function(t){return new(t||f)(n.Hb(a.a))},f.\u0275cmp=n.Bb({type:f,selectors:[["mp-hill-list-row"]],inputs:{hill:"hill"},features:[n.vb],decls:7,vars:3,consts:[[1,"name"],[1,"desc"],["slot","end",3,"name",4,"ngIf"],["slot","end",3,"name"]],template:function(t,e){1&t&&(n.Mb(0,"ion-item"),n.Mb(1,"ion-label"),n.Mb(2,"p",0),n.oc(3),n.Lb(),n.Mb(4,"p",1),n.oc(5),n.Lb(),n.Lb(),n.nc(6,b,1,1,"ion-icon",2),n.Lb()),2&t&&(n.xb(3),n.pc(e.hill.name),n.xb(2),n.pc(e.hill.formattedHeight),n.xb(1),n.dc("ngIf",e.iconName))},directives:[c.p,c.u,l.j,c.o],styles:[".name[_ngcontent-%COMP%]{font-weight:700;color:#000}.desc[_ngcontent-%COMP%]{color:#999}"]}),f);function d(t,e){if(1&t){var i=n.Nb();n.Mb(0,"div"),n.Mb(1,"mp-hill-list-row",4),n.Ub("click",(function(){n.jc(i);var t=e.$implicit;return n.Yb(2).hillSelected.emit(t)})),n.Lb(),n.Lb()}if(2&t){var r=e.$implicit;n.xb(1),n.dc("hill",r)}}function p(t,e){if(1&t&&(n.Mb(0,"ion-virtual-scroll",2),n.nc(1,d,2,1,"div",3),n.Lb()),2&t){var i=n.Yb();n.dc("items",i.hills)("trackBy",i.trackingFn)}}function g(t,e){if(1&t){var i=n.Nb();n.Mb(0,"p"),n.oc(1,"List: "),n.Mb(2,"ion-chip"),n.oc(3),n.Mb(4,"ion-icon",8),n.Ub("click",(function(){return n.jc(i),n.Yb(3).hillFilterService.updateList(null)})),n.Lb(),n.Lb(),n.Lb()}if(2&t){var r=n.Yb(3);n.xb(3),n.qc("",r.listLabel," ")}}function y(t,e){if(1&t){var i=n.Nb();n.Mb(0,"p"),n.oc(1,"Region: "),n.Mb(2,"ion-chip"),n.oc(3),n.Mb(4,"ion-icon",8),n.Ub("click",(function(){return n.jc(i),n.Yb(3).hillFilterService.updateRegion(null)})),n.Lb(),n.Lb(),n.Lb()}if(2&t){var r=n.Yb(3);n.xb(3),n.qc("",r.regionLabel," ")}}function m(t,e){if(1&t&&(n.Mb(0,"p"),n.oc(1,"Status: "),n.Mb(2,"ion-chip"),n.oc(3),n.Lb(),n.Lb()),2&t){var i=n.Yb(3);n.xb(3),n.pc(i.statusLabel)}}function k(t,e){if(1&t){var i=n.Nb();n.Kb(0),n.Mb(1,"h4"),n.oc(2,"No Results"),n.Lb(),n.Mb(3,"p"),n.oc(4),n.Lb(),n.nc(5,g,5,1,"p",6),n.nc(6,y,5,1,"p",6),n.nc(7,m,4,1,"p",6),n.Mb(8,"ion-button",7),n.Ub("click",(function(){return n.jc(i),n.Yb(2).resetFilters()})),n.oc(9,"Clear Filters"),n.Lb(),n.Jb()}if(2&t){var r=n.Yb(2);n.xb(4),n.pc(r.noResultsIntro),n.xb(1),n.dc("ngIf",r.currentFilters.list),n.xb(1),n.dc("ngIf",r.currentFilters.region),n.xb(1),n.dc("ngIf",r.currentFilters.status)}}function S(t,e){if(1&t&&(n.Kb(0),n.Mb(1,"h4"),n.oc(2),n.Zb(3,"titlecase"),n.Lb(),n.Mb(4,"p"),n.oc(5),n.Lb(),n.Jb()),2&t){var i=n.Yb(2);n.xb(2),n.qc("No ",n.ac(3,2,i.friendlyStatus),""),n.xb(3),n.qc("It looks like you haven't added anything to your ",i.friendlyStatus," yet, browse the hill lists or regions to add your favourite hills.")}}function F(t,e){if(1&t&&(n.Mb(0,"article",5),n.nc(1,k,10,4,"ng-container",6),n.nc(2,S,6,4,"ng-container",6),n.Lb()),2&t){var i=n.Yb();n.xb(1),n.dc("ngIf",!i.isStatusOnlySearch),n.xb(1),n.dc("ngIf",i.isStatusOnlySearch)}}var L,w=((L=function(){function t(e){o(this,t),this.hillFilterService=e,this.hillSelected=new n.n,this.hills=[],this.unsubscribe=new r.a}return h(t,[{key:"ngOnInit",value:function(){this.subscribeToData()}},{key:"ngOnDestroy",value:function(){this.unsubscribe.next(),this.unsubscribe.complete()}},{key:"resetFilters",value:function(){this.hillFilterService.resetFilters()}},{key:"trackingFn",value:function(t){return t.id}},{key:"subscribeToData",value:function(){var t=this;this.hillFilterService.filteredHills$.pipe(Object(s.a)(this.unsubscribe)).subscribe((function(e){return t.hills=e}))}},{key:"noResultsIntro",get:function(){var t=this.currentFilters;return"No results found".concat(this.currentTerm?" for '".concat(this.currentTerm,"'"):"").concat(t.list||t.region||t.status?" in:":"")}},{key:"currentFilters",get:function(){return this.hillFilterService.currentFilters}},{key:"currentTerm",get:function(){return this.hillFilterService.currentTerm}},{key:"listLabel",get:function(){var t=this.currentFilters.list;return t?this.hillFilterService.listOptions.find((function(e){return e.value===t})).title:null}},{key:"regionLabel",get:function(){var t=this.currentFilters.region;return t?this.hillFilterService.regionOptions.find((function(e){return e.value===t})).title:null}},{key:"statusLabel",get:function(){var t=this.currentFilters.status;return t?this.hillFilterService.statusOptions.find((function(e){return e.value===t})).title:null}},{key:"isStatusOnlySearch",get:function(){return this.currentFilters.status&&!this.currentFilters.list&&!this.currentFilters.region&&!this.currentTerm}},{key:"friendlyStatus",get:function(){return"climbed"===this.currentFilters.status?"climbed hills":this.currentFilters.status}}]),t}()).\u0275fac=function(t){return new(t||L)(n.Hb(u.a))},L.\u0275cmp=n.Bb({type:L,selectors:[["mp-hill-list"]],outputs:{hillSelected:"hillSelected"},decls:2,vars:2,consts:[[3,"items","trackBy",4,"ngIf"],["class","ion-padding",4,"ngIf"],[3,"items","trackBy"],[4,"virtualItem"],[3,"hill","click"],[1,"ion-padding"],[4,"ngIf"],[3,"click"],["name","close",3,"click"]],template:function(t,e){1&t&&(n.nc(0,p,2,2,"ion-virtual-scroll",0),n.nc(1,F,3,2,"article",1)),2&t&&(n.dc("ngIf",e.hills.length),n.xb(1),n.dc("ngIf",!e.hills.length))},directives:[l.j,c.M,c.Y,v,c.f,c.h,c.o],pipes:[l.m],styles:[""]}),L)}}])}();